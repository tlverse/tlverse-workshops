<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Stochastic Treatment Regimes (optional) | [Workshop] Targeted Learning in the tlverse</title>
<meta name="author" content="Mark van der Laan, Alan Hubbard, Jeremy Coyle, Nima Hejazi, Ivana Malenica, Rachael Phillips">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.9000/tabs.js"></script><script src="libs/bs3compat-0.2.5.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body>
<span class="math inline">
  \(\DeclareMathOperator{\expit}{expit}\)
  \(\DeclareMathOperator{\logit}{logit}\)
  \(\DeclareMathOperator*{\argmin}{\arg\!\min}\)
  \(\newcommand{\indep}{\perp\!\!\!\perp}\)
  \(\newcommand{\coloneqq}{\mathrel{=}}\)
  \(\newcommand{\R}{\mathbb{R}}\)
  \(\newcommand{\E}{\mathbb{E}}\)
  \(\newcommand{\M}{\mathcal{M}}\)
  \(\renewcommand{\P}{\mathbb{P}}\)
  \(\newcommand{\I}{\mathbb{I}}\)
  \(\newcommand{\1}{\mathbbm{1}}\)
  </span>
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Causal Inference Meets Machine Learning">[Workshop] Targeted Learning in the <code>tlverse</code></a>:
        <small class="text-muted">Causal Inference Meets Machine Learning</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="motivation.html">Motivation</a></li>
<li><a class="" href="tlverse.html"><span class="header-section-number">1</span> Welcome to the tlverse</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> The Roadmap for Targeted Learning</a></li>
<li><a class="" href="sl3.html"><span class="header-section-number">3</span> Super (Machine) Learning</a></li>
<li><a class="" href="tmle3.html"><span class="header-section-number">4</span> The TMLE Framework</a></li>
<li><a class="" href="optimal-individualized-treatment-regimes-optional.html"><span class="header-section-number">5</span> Optimal Individualized Treatment Regimes (optional)</a></li>
<li><a class="active" href="stochastic-treatment-regimes-optional.html"><span class="header-section-number">6</span> Stochastic Treatment Regimes (optional)</a></li>
<li><a class="" href="r6.html"><span class="header-section-number">7</span> A Primer on the R6 Class System</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tlverse/tlverse-workshops">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="stochastic-treatment-regimes-optional" class="section level1">
<h1>
<span class="header-section-number">6</span> Stochastic Treatment Regimes (optional)<a class="anchor" aria-label="anchor" href="#stochastic-treatment-regimes-optional"><i class="fas fa-link"></i></a>
</h1>
<p><em>Nima Hejazi</em></p>
<p>Based on the <a href="https://github.com/tlverse/tmle3shift"><code>tmle3shift</code> <code>R</code> package</a>
by <em>Nima Hejazi, Jeremy Coyle, and Mark van der Laan</em>.</p>
<p>Updated: 2021-05-20</p>
<div id="learning-objectives-4" class="section level2">
<h2>
<span class="header-section-number">6.1</span> Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Differentiate stochastic treatment regimes from static, dynamic, and optimal
treatment regimes.</li>
<li>Describe how estimating causal effects of stochastic interventions informs a
real-world data analysis.</li>
<li>Contrast a population level stochastic intervention policy from a modified
treatment policy.</li>
<li>Estimate causal effects under stochastic treatment regimes with the
<code>tmle3shift</code> <code>R</code> package.</li>
<li>Specify a grid of counterfactual shift interventions to be used for defining
a set of stochastic intervention policies.</li>
<li>Interpret a set of effect estimates from a grid of counterfactual shift
interventions.</li>
<li>Construct marginal structural models to measure variable importance in terms
of stochastic interventions, using a grid of shift interventions.</li>
<li>Implement a shift intervention at the individual level, to facilitate
shifting each individual to a value that’s supported by the data.</li>
<li>Define novel shift intervention functions to extend the <code>tmle3shift</code> <code>R</code>
package.</li>
</ol>
</div>
<div id="introduction-2" class="section level2">
<h2>
<span class="header-section-number">6.2</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-2"><i class="fas fa-link"></i></a>
</h2>
<p>In this section, we examine a simple example of stochastic treatment regimes in
the context of a continuous treatment variable of interest, defining an
intuitive causal effect through which to examine stochastic interventions more
generally. As a first step to using stochastic
treatment regimes in practice, we present the <a href="https://github.com/tlverse/tmle3shift"><code>tmle3shift</code> R
package</a>, which features an
implementation of a recently developed algorithm for computing targeted minimum
loss-based estimates of a causal effect based on a stochastic treatment regime
that shifts the natural value of the treatment based on a shifting function
<span class="math inline">\(d(A,W)\)</span>. We will also use <code>tmle3shift</code> to construct marginal structural models
for variable importance measures, implement shift interventions at the
individual level, and define novel shift intervention functions.</p>
</div>
<div id="stochastic-interventions" class="section level2">
<h2>
<span class="header-section-number">6.3</span> Stochastic Interventions<a class="anchor" aria-label="anchor" href="#stochastic-interventions"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Present a relatively simple yet extremely flexible manner by which <em>realistic</em>
causal effects (and contrasts thereof) may be defined.</p></li>
<li><p>May be applied to nearly any manner of treatment variable – continuous,
ordinal, categorical, binary – allowing for a rich set of causal effects to
be defined through this formalism.</p></li>
<li><p>Arguably the most general of the classes of interventions through which causal
effects may be defined, and are conceptually simple.</p></li>
<li>
<p>We may consider stochastic interventions in two ways:</p>
<ol style="list-style-type: decimal">
<li><p>The equation <span class="math inline">\(f_A\)</span>, which produces <span class="math inline">\(A\)</span>, is replaced by a probabilistic
mechanism <span class="math inline">\(g_{\delta}(A \mid W)\)</span> that differs from the original <span class="math inline">\(g(A \mid W)\)</span>. The <em>stochastically modified</em> value of the treatment <span class="math inline">\(A_{\delta}\)</span> is
drawn from a user-specified distribution <span class="math inline">\(g_\delta(A \mid W)\)</span>, which may
depend on the original distribution <span class="math inline">\(g(A \mid W)\)</span> and is indexed by a
user-specified parameter <span class="math inline">\(\delta\)</span>. In this case, the stochastically
modified value of the treatment <span class="math inline">\(A_{\delta} \sim g_{\delta}(\cdot \mid W)\)</span>.</p></li>
<li><p>The observed value <span class="math inline">\(A\)</span> is replaced by a new value <span class="math inline">\(A_{d(A,W)}\)</span> based on
applying a user-defined function <span class="math inline">\(d(A,W)\)</span> to <span class="math inline">\(A\)</span>. In this case, the
stochastic treatment regime may be viewed as an intervention in which <span class="math inline">\(A\)</span>
is set equal to a value based on a hypothetical regime <span class="math inline">\(d(A, W)\)</span>, where
regime <span class="math inline">\(d\)</span> depends on the treatment level <span class="math inline">\(A\)</span> that would be assigned in the
absence of the regime as well as the covariates <span class="math inline">\(W\)</span>. Stochastic
interventions of this variety may be referred to as depending on the
<em>natural value of treatment</em> or as <em>modified treatment policies</em>
<span class="citation">(Haneuse and Rotnitzky <a href="references.html#ref-haneuse2013estimation" role="doc-biblioref">2013</a>; Young, Hernán, and Robins <a href="references.html#ref-young2014identification" role="doc-biblioref">2014</a>)</span>.</p></li>
</ol>
</li>
</ul>
<div id="identifying-the-causal-effect-of-a-stochastic-intervention" class="section level3">
<h3>
<span class="header-section-number">6.3.1</span> Identifying the Causal Effect of a Stochastic Intervention<a class="anchor" aria-label="anchor" href="#identifying-the-causal-effect-of-a-stochastic-intervention"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>The stochastic intervention generates a counterfactual random variable
<span class="math inline">\(Y_{d(A,W)} := f_Y(d(A,W), W, U_Y) \equiv Y_{g_{\delta}} := f_Y(A_{\delta}, W, U_Y)\)</span>, where <span class="math inline">\(Y_{d(A,W)} \sim \mathcal{P}_0^{\delta}\)</span>.</p></li>
<li><p>The target causal estimand of our analysis is <span class="math inline">\(\psi_{0, \delta} := \mathbb{E}_{P_0^{\delta}}\{Y_{d(A,W)}\}\)</span>, the mean of the counterfactual
outcome variable <span class="math inline">\(Y_{d(A, W)}\)</span>. The statistical target parameter may also be
denoted <span class="math inline">\(\Psi(P_0) = \mathbb{E}_{P_0}{\overline{Q}(d(A, W), W)}\)</span>, where
<span class="math inline">\(\overline{Q}(d(A, W), W)\)</span> is the counterfactual outcome value of a given
individual under the stochastic intervention distribution
<span class="citation">(Dı́az and van der Laan <a href="references.html#ref-diaz2018stochastic" role="doc-biblioref">2018</a>)</span>.</p></li>
<li><p>In prior work, <span class="citation">Dı́az and van der Laan (<a href="references.html#ref-diaz2012population" role="doc-biblioref">2012</a>)</span> showed that the causal quantity of interest
<span class="math inline">\(\mathbb{E}_0 \{Y_{d(A, W)}\}\)</span> is identified by a functional of the
distribution of <span class="math inline">\(O\)</span>:
<span class="math display">\[\begin{align*}\label{eqn:identification2012}
  \psi_{0,d} = \int_{\mathcal{W}} \int_{\mathcal{A}} &amp; \mathbb{E}_{P_0}
   \{Y \mid A = d(a, w), W = w\} \cdot \\ &amp;q_{0, A}^O(a \mid W = w) \cdot
   q_{0, W}^O(w) d\mu(a)d\nu(w).
\end{align*}\]</span></p></li>
<li>
<p>The four standard assumptions presented in  are necessary in order
to establish identifiability of the causal parameter from the observed data
via the statistical functional. These were</p>
<ol style="list-style-type: decimal">
<li>
<em>Consistency</em>: <span class="math inline">\(Y^{d(a_i, w_i)}_i = Y_i\)</span> in the event <span class="math inline">\(A_i = d(a_i, w_i)\)</span>,
for <span class="math inline">\(i = 1, \ldots, n\)</span>
</li>
<li>
<em>Stable unit value treatment assumption (SUTVA)</em>: <span class="math inline">\(Y^{d(a_i, w_i)}_i\)</span> does
not depend on <span class="math inline">\(d(a_j, w_j)\)</span> for <span class="math inline">\(i = 1, \ldots, n\)</span> and <span class="math inline">\(j \neq i\)</span>, or lack
of interference <span class="citation">(Rubin <a href="references.html#ref-rubin1978bayesian" role="doc-biblioref">1978</a>, <a href="references.html#ref-rubin1980randomization" role="doc-biblioref">1980</a>)</span>.</li>
<li>
<em>Strong ignorability</em>: <span class="math inline">\(A_i \perp \!\!\! \perp Y^{d(a_i, w_i)}_i \mid W_i\)</span>,
for <span class="math inline">\(i = 1, \ldots, n\)</span>.</li>
<li>
<em>Positivity (or overlap)</em>: <span class="math inline">\(a_i \in \mathcal{A} \implies d(a_i, w_i) \in \mathcal{A}\)</span> for all <span class="math inline">\(w \in \mathcal{W}\)</span>, where <span class="math inline">\(\mathcal{A}\)</span> denotes the
support of <span class="math inline">\(A \mid W = w_i \quad \forall i = 1, \ldots n\)</span>.</li>
</ol>
</li>
<li><p>With the identification assumptions satisfied, <span class="citation">Dı́az and van der Laan (<a href="references.html#ref-diaz2012population" role="doc-biblioref">2012</a>)</span> and
<span class="citation">Dı́az and van der Laan (<a href="references.html#ref-diaz2018stochastic" role="doc-biblioref">2018</a>)</span> provide an efficient influence function with respect to
the nonparametric model <span class="math inline">\(\mathcal{M}\)</span> as
<span class="math display">\[\begin{equation*}\label{eqn:eif}
  D(P_0)(x) = H(a, w)({y - \overline{Q}(a, w)}) +
  \overline{Q}(d(a, w), w) - \Psi(P_0),
\end{equation*}\]</span>
where the auxiliary covariate <span class="math inline">\(H(a,w)\)</span> may be expressed
<span class="math display">\[\begin{equation*}\label{eqn:aux_covar_full}
  H(a,w) = \mathbb{I}(a + \delta &lt; u(w)) \frac{g_0(a - \delta \mid w)} {g_0(a \mid w)}
    + \mathbb{I}(a + \delta \geq u(w)),
\end{equation*}\]</span>
which may be reduced to
<span class="math display">\[\begin{equation*}\label{eqn:aux_covar_simple}
  H(a,w) = \frac{g_0(a - \delta \mid w)}{g_0(a \mid w)} + 1
\end{equation*}\]</span>
in the case that the treatment is in the limits that arise from conditioning
on <span class="math inline">\(W\)</span>, i.e., for <span class="math inline">\(A_i \in (u(w) - \delta, u(w))\)</span>.</p></li>
</ul>
</div>
<div id="interpreting-the-causal-effect-of-a-stochastic-intervention" class="section level3">
<h3>
<span class="header-section-number">6.3.2</span> Interpreting the Causal Effect of a Stochastic Intervention<a class="anchor" aria-label="anchor" href="#interpreting-the-causal-effect-of-a-stochastic-intervention"><i class="fas fa-link"></i></a>
</h3>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="img/gif/shift_animation.gif" alt="Animation of how a counterfactual outcome changes as the natural treatment distribution is subjected to a simple stochastic intervention" width="60%"><p class="caption">
FIGURE 5.1: Animation of how a counterfactual outcome changes as the natural treatment distribution is subjected to a simple stochastic intervention
</p>
</div>
</div>
</div>
<div id="estimating-the-causal-effect-of-a-stochastic-intervention-with-tmle3shift" class="section level2">
<h2>
<span class="header-section-number">6.4</span> Estimating the Causal Effect of a Stochastic Intervention with <code>tmle3shift</code><a class="anchor" aria-label="anchor" href="#estimating-the-causal-effect-of-a-stochastic-intervention-with-tmle3shift"><i class="fas fa-link"></i></a>
</h2>
<p>We use <code>tmle3shift</code> to construct a targeted maximum likelihood (TML) estimator of
of a causal effect of a stochastic treatment regime that shifts the natural
value of the treatment based on a shifting function <span class="math inline">\(d(A,W)\)</span>. We will follow
the recipe provided by <span class="citation">Dı́az and van der Laan (<a href="references.html#ref-diaz2018stochastic" role="doc-biblioref">2018</a>)</span>, tailored to the <code>tmle3</code> framework:</p>
<ol style="list-style-type: decimal">
<li>Construct initial estimators <span class="math inline">\(g_n\)</span> of <span class="math inline">\(g_0(A, W)\)</span> and <span class="math inline">\(Q_n\)</span> of
<span class="math inline">\(\overline{Q}_0(A, W)\)</span>, perhaps using data-adaptive regression techniques.</li>
<li>For each observation <span class="math inline">\(i\)</span>, compute an estimate <span class="math inline">\(H_n(a_i, w_i)\)</span> of the
auxiliary covariate <span class="math inline">\(H(a_i,w_i)\)</span>.</li>
<li>Estimate the parameter <span class="math inline">\(\epsilon\)</span> in the logistic regression model
<span class="math display">\[ \text{logit}\overline{Q}_{\epsilon, n}(a, w) =
\text{logit}\overline{Q}_n(a, w) + \epsilon H_n(a, w),\]</span>
or an alternative regression model incorporating weights.</li>
<li>Compute TML estimator <span class="math inline">\(\Psi_n\)</span> of the target parameter, defining update
<span class="math inline">\(\overline{Q}_n^{\star}\)</span> of the initial estimate
<span class="math inline">\(\overline{Q}_{n, \epsilon_n}\)</span>:
<span class="math display">\[\begin{equation*}\label{eqn:tmle}
  \Psi_n = \Psi(P_n^{\star}) = \frac{1}{n} \sum_{i = 1}^n
  \overline{Q}_n^{\star}(d(A_i, W_i), W_i).
\end{equation*}\]</span>
</li>
</ol>
<p>To start, let’s load the packages we’ll use and set a seed for simulation:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3">sl3</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/tmle3">tmle3</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/tmle3shift">tmle3shift</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">429153</span><span class="op">)</span></code></pre></div>
<p><strong>1. Construct initial estimators <span class="math inline">\(g_n\)</span> of <span class="math inline">\(g_0(A, W)\)</span> and <span class="math inline">\(Q_n\)</span> of
<span class="math inline">\(\overline{Q}_0(A, W)\)</span>.</strong></p>
<p>We need to estimate two components of the likelihood in order to construct a
TML estimator.</p>
<ol style="list-style-type: decimal">
<li>The outcome regression, <span class="math inline">\(\hat{Q}_n\)</span>, which is a simple regression of the
form <span class="math inline">\(\mathbb{E}[Y \mid A,W]\)</span>.</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># learners used for conditional expectation regression</span>
<span class="va">mean_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_mean.html">Lrnr_mean</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="va">fglm_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glm_fast.html">Lrnr_glm_fast</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="va">xgb_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_xgboost.html">Lrnr_xgboost</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>nrounds <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">sl_regression_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_sl.html">Lrnr_sl</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  learners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mean_learner</span>, <span class="va">fglm_learner</span>, <span class="va">xgb_learner</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>The second of these is an estimate of the treatment mechanism, <span class="math inline">\(\hat{g}_n\)</span>,
i.e., the <em>propensity score</em>. In the case of a continuous intervention node
<span class="math inline">\(A\)</span>, such a quantity takes the form <span class="math inline">\(p(A \mid W)\)</span>, which is a conditional
density. Generally speaking, conditional density estimation is a challenging
problem that has received much attention in the literature. To estimate the
treatment mechanism, we must make use of learning algorithms specifically
suited to conditional density estimation; a list of such learners may be
extracted from <code>sl3</code> by using <code><a href="https://tlverse.org/sl3/reference/list_learners.html">sl3_list_learners()</a></code>:</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tlverse.org/sl3/reference/list_learners.html">sl3_list_learners</a></span><span class="op">(</span><span class="st">"density"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Lrnr_density_discretize"     "Lrnr_density_hse"           </span>
<span class="co">#&gt; [3] "Lrnr_density_semiparametric" "Lrnr_haldensify"            </span>
<span class="co">#&gt; [5] "Lrnr_solnp_density"</span></code></pre></div>
<p>To proceed, we’ll select two of the above learners, <code>Lrnr_haldensify</code> for using
the highly adaptive lasso for conditional density estimation, based on an
algorithm given by <span class="citation">Dı́az and van der Laan (<a href="references.html#ref-diaz2011super" role="doc-biblioref">2011</a>)</span> and implemented in <span class="citation">Hejazi, Benkeser, and van der Laan (<a href="references.html#ref-hejazi2020haldensify" role="doc-biblioref">2020</a>)</span>, and
semiparametric location-scale conditional density estimators implemented in the
<a href="https://github.com/tlverse/sl3"><code>sl3</code> package</a>. A Super Learner may be
constructed by pooling estimates from each of these modified conditional
density estimation techniques.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># learners used for conditional densities (i.e., generalized propensity score)</span>
<span class="va">haldensify_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_haldensify.html">Lrnr_haldensify</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  n_bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
  lambda_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">10</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># semiparametric density estimator based on homoscedastic errors (HOSE)</span>
<span class="va">hose_learner_xgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/sl3/reference/Lrnr_base.html">make_learner</a></span><span class="op">(</span><span class="va">Lrnr_density_semiparametric</span>,
  mean_learner <span class="op">=</span> <span class="va">xgb_learner</span>
<span class="op">)</span>
<span class="co"># semiparametric density estimator based on heteroscedastic errors (HESE)</span>
<span class="va">hese_learner_xgb_fglm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/sl3/reference/Lrnr_base.html">make_learner</a></span><span class="op">(</span><span class="va">Lrnr_density_semiparametric</span>,
  mean_learner <span class="op">=</span> <span class="va">xgb_learner</span>,
  var_learner <span class="op">=</span> <span class="va">fglm_learner</span>
<span class="op">)</span>
<span class="co"># SL for the conditional treatment density</span>
<span class="va">sl_density_learner</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_sl.html">Lrnr_sl</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  learners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">haldensify_learner</span>, <span class="va">hose_learner_xgb</span>,
                  <span class="va">hese_learner_xgb_fglm</span><span class="op">)</span>,
  metalearner <span class="op">=</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_solnp_density.html">Lrnr_solnp_density</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Finally, we construct a <code>learner_list</code> object for use in constructing a TML
estimator of our target parameter of interest:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q_learner</span> <span class="op">&lt;-</span> <span class="va">sl_regression_learner</span>
<span class="va">g_learner</span> <span class="op">&lt;-</span> <span class="va">sl_density_learner</span>
<span class="va">learner_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Q_learner</span>, A <span class="op">=</span> <span class="va">g_learner</span><span class="op">)</span></code></pre></div>
<div id="simulate-data-1" class="section level3">
<h3>
<span class="header-section-number">6.4.1</span> Simulate Data<a class="anchor" aria-label="anchor" href="#simulate-data-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulate simple data for tmle-shift sketch</span>
<span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># number of observations</span>
<span class="va">tx_mult</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># multiplier for the effect of W = 1 on the treatment</span>

<span class="co">## baseline covariates -- simple, binary</span>
<span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>

<span class="co">## create treatment based on baseline W</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">tx_mult</span> <span class="op">*</span> <span class="va">W</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co">## create outcome as a linear function of A, W + white noise</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">W</span><span class="op">)</span><span class="op">)</span>

<span class="co"># organize data and nodes for tmle3</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">W</span>, <span class="va">A</span>, <span class="va">Y</span><span class="op">)</span>
<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"W1"</span>, <span class="st">"W2"</span>, <span class="st">"A"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span>
<span class="va">node_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"W1"</span>, <span class="st">"W2"</span><span class="op">)</span>, A <span class="op">=</span> <span class="st">"A"</span>, Y <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt;    W1 W2        A Y</span>
<span class="co">#&gt; 1:  1  1  3.58065 1</span>
<span class="co">#&gt; 2:  1  0  3.20718 1</span>
<span class="co">#&gt; 3:  1  1  1.03584 1</span>
<span class="co">#&gt; 4:  0  0 -0.65785 1</span>
<span class="co">#&gt; 5:  1  1  3.01990 1</span>
<span class="co">#&gt; 6:  1  1  2.78031 1</span></code></pre></div>
<p>We now have an observed data structure (<code>data</code>) and a specification of the role
that each variable in the data set plays as the nodes in a <em>directed acyclic
graph</em> (DAG) via <em>nonparametric structural equation models</em> (NPSEMs).</p>
<p>To start, we will initialize a specification for the TMLE of our parameter of
interest (a <code>tmle3_Spec</code> in the <code>tlverse</code> nomenclature) simply by calling
<code>tmle_shift</code>. We specify the argument <code>shift_val = 0.5</code> when initializing the
<code>tmle3_Spec</code> object to communicate that we’re interested in a shift of <span class="math inline">\(0.5\)</span> on
the scale of the treatment <span class="math inline">\(A\)</span> – that is, we specify <span class="math inline">\(\delta = 0.5\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize a tmle specification</span>
<span class="va">tmle_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/tmle3shift/reference/tmle_shift.html">tmle_shift</a></span><span class="op">(</span>
  shift_val <span class="op">=</span> <span class="fl">0.5</span>,
  shift_fxn <span class="op">=</span> <span class="va">shift_additive</span>,
  shift_fxn_inv <span class="op">=</span> <span class="va">shift_additive_inv</span>
<span class="op">)</span></code></pre></div>
<p>As seen above, the <code>tmle_shift</code> specification object (like all <code>tmle3_Spec</code>
objects) does <em>not</em> store the data for our specific analysis of interest. Later,
we’ll see that passing a data object directly to the <code>tmle3</code> wrapper function,
alongside the instantiated <code>tmle_spec</code>, will serve to construct a <code>tmle3_Task</code>
object internally (see the <code>tmle3</code> documentation for details).</p>
<!--
Note that in the initialization of the `tmle3_Spec`, we specified a shifting
function `shift_additive_bounded` (and its inverse). This shifting function
corresponds to a stochastic regime slightly more complicated than that
initially considered in @diaz2018stochastic. In particular,
`shift_additive_bounded` is encapsulates a procedure that determines an
acceptable set of shifting values for the shift $\delta$, allowing for the
observed treatment value of a given observation to be shifted if the auxiliary
covariate $H_n$ is bounded by a constant and not shifting the given observation
if this criterion does not hold. We discuss this in greater detail in the
sequel.
-->
</div>
<div id="targeted-estimation-of-stochastic-interventions-effects" class="section level3">
<h3>
<span class="header-section-number">6.4.2</span> Targeted Estimation of Stochastic Interventions Effects<a class="anchor" aria-label="anchor" href="#targeted-estimation-of-stochastic-interventions-effects"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmle_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle3.html">tmle3</a></span><span class="op">(</span><span class="va">tmle_spec</span>, <span class="va">data</span>, <span class="va">node_list</span>, <span class="va">learner_list</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iter: 1 fn: 1384.5336     Pars:  0.22969279 0.00001885 0.77028836</span>
<span class="co">#&gt; Iter: 2 fn: 1384.5336     Pars:  0.229692876 0.000007582 0.770299542</span>
<span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span>
<span class="va">tmle_fit</span>
<span class="co">#&gt; A tmle3_Fit that took 1 step(s)</span>
<span class="co">#&gt;    type         param init_est tmle_est      se   lower   upper psi_transformed</span>
<span class="co">#&gt; 1:  TSM E[Y_{A=NULL}]   0.8008  0.79855 0.01284 0.77339 0.82372         0.79855</span>
<span class="co">#&gt;    lower_transformed upper_transformed</span>
<span class="co">#&gt; 1:           0.77339           0.82372</span></code></pre></div>
<p>The <code>print</code> method of the resultant <code>tmle_fit</code> object conveniently displays the
results from computing our TML estimator.</p>
</div>
</div>
<div id="stochastic-interventions-over-a-grid-of-counterfactual-shifts" class="section level2">
<h2>
<span class="header-section-number">6.5</span> Stochastic Interventions over a Grid of Counterfactual Shifts<a class="anchor" aria-label="anchor" href="#stochastic-interventions-over-a-grid-of-counterfactual-shifts"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Consider an arbitrary scalar <span class="math inline">\(\delta\)</span> that defines a counterfactual outcome
<span class="math inline">\(\psi_n = Q_n(d(A, W), W)\)</span>, where, for simplicity, let <span class="math inline">\(d(A, W) = A + \delta\)</span>.
A simplified expression of the auxiliary covariate for the TMLE of <span class="math inline">\(\psi\)</span> is
<span class="math inline">\(H_n = \frac{g^{\star}(a \mid w)}{g(a \mid w)}\)</span>, where <span class="math inline">\(g^{\star}(a \mid w)\)</span>
defines the treatment mechanism with the stochastic intervention implemented.
In this manner, we can specify a <em>grid</em> of shifts <span class="math inline">\(\delta\)</span> to define a set of
stochastic intervention policies in an <em>a priori</em> manner.</p></li>
<li><p>To ascertain whether a given choice of the shift <span class="math inline">\(\delta\)</span> is acceptable, let
there be a bound <span class="math inline">\(C(\delta) = \frac{g^{\star}(a \mid w)}{g(a \mid w)} \leq M\)</span>,
where <span class="math inline">\(g^{\star}(a \mid w)\)</span> is a function of <span class="math inline">\(\delta\)</span> in part, and <span class="math inline">\(M\)</span> is a
user-specified upper bound of <span class="math inline">\(C(\delta)\)</span>. Then, <span class="math inline">\(C(\delta)\)</span> is a measure of
the influence of a given observation (under a bound of the ratio of the
conditional densities), which provides a way to limit the maximum influence of
a given observation through a choice of the shift <span class="math inline">\(\delta\)</span>.</p></li>
<li><p>For the purpose of using such a shift in practice, the present software
provides the functions <code>shift_additive_bounded</code> and
<code>shift_additive_bounded_inv</code>, which define a variation of this shift:
<span class="math display">\[\begin{equation}
  \delta(a, w) =
    \begin{cases}
      \delta, &amp; C(\delta) \leq M \\
      0, \text{otherwise} \\
    \end{cases},
\end{equation}\]</span>
which corresponds to an intervention in which the natural value of treatment
of a given observational unit is shifted by a value <span class="math inline">\(\delta\)</span> in the case that
the ratio of the intervened density <span class="math inline">\(g^{\star}(a \mid w)\)</span> to the natural
density <span class="math inline">\(g(a \mid w)\)</span> (that is, <span class="math inline">\(C(\delta)\)</span>) does not exceed a bound <span class="math inline">\(M\)</span>. In
the case that the ratio <span class="math inline">\(C(\delta)\)</span> exceeds the bound <span class="math inline">\(M\)</span>, the stochastic
intervention policy does not apply to the given unit and they remain at their
natural value of treatment <span class="math inline">\(a\)</span>.</p></li>
</ul>
<div id="initializing-vimshift-through-its-tmle3_spec" class="section level3">
<h3>
<span class="header-section-number">6.5.1</span> Initializing <code>vimshift</code> through its <code>tmle3_Spec</code><a class="anchor" aria-label="anchor" href="#initializing-vimshift-through-its-tmle3_spec"><i class="fas fa-link"></i></a>
</h3>
<p>To start, we will initialize a specification for the TMLE of our parameter of
interest (called a <code>tmle3_Spec</code> in the <code>tlverse</code> nomenclature) simply by calling
<code>tmle_shift</code>. We specify the argument <code>shift_grid = seq(-1, 1, by = 1)</code>
when initializing the <code>tmle3_Spec</code> object to communicate that we’re interested
in assessing the mean counterfactual outcome over a grid of shifts -1, 0, 1 on the scale of the treatment <span class="math inline">\(A\)</span>.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># what's the grid of shifts we wish to consider?</span>
<span class="va">delta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># initialize a tmle specification</span>
<span class="va">tmle_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/tmle3shift/reference/tmle_vimshift_delta.html">tmle_vimshift_delta</a></span><span class="op">(</span>
  shift_grid <span class="op">=</span> <span class="va">delta_grid</span>,
  max_shifted_ratio <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="targeted-estimation-of-stochastic-intervention-effects" class="section level3">
<h3>
<span class="header-section-number">6.5.2</span> Targeted Estimation of Stochastic Intervention Effects<a class="anchor" aria-label="anchor" href="#targeted-estimation-of-stochastic-intervention-effects"><i class="fas fa-link"></i></a>
</h3>
<p>One may walk through the step-by-step procedure for fitting the TML estimator
of the mean counterfactual outcome under each shift in the grid, using the
machinery exposed by the <a href="https://tlverse.org/tmle3"><code>tmle3</code> R package</a>, or
simply invoke the <code>tmle3</code> wrapper function to fit the series of TML estimators
(one for each parameter defined by the grid delta) in a single function call.
For convenience, we choose the latter:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmle_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle3.html">tmle3</a></span><span class="op">(</span><span class="va">tmle_spec</span>, <span class="va">data</span>, <span class="va">node_list</span>, <span class="va">learner_list</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iter: 1 fn: 1385.8594     Pars:  0.25208827 0.00004768 0.74786405</span>
<span class="co">#&gt; Iter: 2 fn: 1385.8594     Pars:  0.25208843 0.00002901 0.74788255</span>
<span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span>
<span class="va">tmle_fit</span>
<span class="co">#&gt; A tmle3_Fit that took 1 step(s)</span>
<span class="co">#&gt;          type          param init_est tmle_est        se   lower   upper</span>
<span class="co">#&gt; 1:        TSM  E[Y_{A=NULL}]  0.61655  0.61546 0.0140007 0.58802 0.64290</span>
<span class="co">#&gt; 2:        TSM  E[Y_{A=NULL}]  0.74115  0.73899 0.0138954 0.71176 0.76623</span>
<span class="co">#&gt; 3:        TSM  E[Y_{A=NULL}]  0.84917  0.84374 0.0107174 0.82274 0.86475</span>
<span class="co">#&gt; 4: MSM_linear MSM(intercept)  0.73563  0.73273 0.0120788 0.70906 0.75641</span>
<span class="co">#&gt; 5: MSM_linear     MSM(slope)  0.11631  0.11414 0.0053805 0.10360 0.12469</span>
<span class="co">#&gt;    psi_transformed lower_transformed upper_transformed</span>
<span class="co">#&gt; 1:         0.61546           0.58802           0.64290</span>
<span class="co">#&gt; 2:         0.73899           0.71176           0.76623</span>
<span class="co">#&gt; 3:         0.84374           0.82274           0.86475</span>
<span class="co">#&gt; 4:         0.73273           0.70906           0.75641</span>
<span class="co">#&gt; 5:         0.11414           0.10360           0.12469</span></code></pre></div>
<p><em>Remark</em>: The <code>print</code> method of the resultant <code>tmle_fit</code> object conveniently
displays the results from computing our TML estimator.</p>
</div>
<div id="inference-with-marginal-structural-models" class="section level3">
<h3>
<span class="header-section-number">6.5.3</span> Inference with Marginal Structural Models<a class="anchor" aria-label="anchor" href="#inference-with-marginal-structural-models"><i class="fas fa-link"></i></a>
</h3>
<p>Since we consider estimating the mean counterfactual outcome <span class="math inline">\(\psi_n\)</span> under
several values of the intervention <span class="math inline">\(\delta\)</span>, taken from the aforementioned
<span class="math inline">\(\delta\)</span>-grid, one approach for obtaining inference on a single summary measure
of these estimated quantities involves leveraging working marginal structural
models (MSMs). Summarizing the estimates <span class="math inline">\(\psi_n\)</span> through a working MSM allows
for inference on the <em>trend</em> imposed by a <span class="math inline">\(\delta\)</span>-grid to be evaluated via a
simple hypothesis test on a parameter of this working MSM. Letting
<span class="math inline">\(\psi_{\delta}(P_0)\)</span> be the mean outcome under a shift <span class="math inline">\(\delta\)</span> of the
treatment, we have <span class="math inline">\(\vec{\psi}_{\delta} = (\psi_{\delta}: \delta)\)</span> with
corresponding estimators <span class="math inline">\(\vec{\psi}_{n, \delta} = (\psi_{n, \delta}: \delta)\)</span>.
Further, let <span class="math inline">\(\beta(\vec{\psi}_{\delta}) = \phi((\psi_{\delta}: \delta))\)</span>. By a
straightforward application of the delta method (discussed previously), we may
write the efficient influence function of the MSM parameter <span class="math inline">\(\beta\)</span> in terms of
the EIFs of each of the corresponding point estimates. Based on this, inference
from a working MSM is rather straightforward. To wit, the limiting distribution
for <span class="math inline">\(m_{\beta}(\delta)\)</span> may be expressed <span class="math display">\[\sqrt{n}(\beta_n - \beta_0) \to N(0,
\Sigma),\]</span> where <span class="math inline">\(\Sigma\)</span> is the empirical covariance matrix of
<span class="math inline">\(\text{EIF}_{\beta}(O)\)</span>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmle_fit</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>
<span class="co">#&gt;          type          param init_est tmle_est        se   lower   upper</span>
<span class="co">#&gt; 1: MSM_linear MSM(intercept)  0.73563  0.73273 0.0120788 0.70906 0.75641</span>
<span class="co">#&gt; 2: MSM_linear     MSM(slope)  0.11631  0.11414 0.0053805 0.10360 0.12469</span>
<span class="co">#&gt;    psi_transformed lower_transformed upper_transformed</span>
<span class="co">#&gt; 1:         0.73273           0.70906           0.75641</span>
<span class="co">#&gt; 2:         0.11414           0.10360           0.12469</span></code></pre></div>
</div>
<div id="directly-targeting-the-msm-parameter-beta" class="section level3">
<h3>
<span class="header-section-number">6.5.4</span> Directly Targeting the MSM Parameter <span class="math inline">\(\beta\)</span><a class="anchor" aria-label="anchor" href="#directly-targeting-the-msm-parameter-beta"><i class="fas fa-link"></i></a>
</h3>
<p>Note that in the above, a working MSM is fit to the individual TML estimates of
the mean counterfactual outcome under a given value of the shift <span class="math inline">\(\delta\)</span> in
the supplied grid. The parameter of interest <span class="math inline">\(\beta\)</span> of the MSM is
asymptotically linear (and, in fact, a TML estimator) as a consequence of its
construction from individual TML estimators. In smaller samples, it may be
prudent to perform a TML estimation procedure that targets the parameter
<span class="math inline">\(\beta\)</span> directly, as opposed to constructing it from several independently
targeted TML estimates. An approach for constructing such an estimator is
proposed in the sequel.</p>
<p>Suppose a simple working MSM <span class="math inline">\(\mathbb{E}Y_{g^0_{\delta}} = \beta_0 + \beta_1 \delta\)</span>, then a TML estimator targeting <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> may be
constructed as
<span class="math display">\[\overline{Q}_{n, \epsilon}(A,W) = \overline{Q}_n(A,W) + \epsilon (H_1(g),
H_2(g),\]</span> for all <span class="math inline">\(\delta\)</span>, where <span class="math inline">\(H_1(g)\)</span> is the auxiliary covariate for
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(H_2(g)\)</span> is the auxiliary covariate for <span class="math inline">\(\beta_1\)</span>.</p>
<p>To construct a targeted maximum likelihood estimator that directly targets the
parameters of the working marginal structural model, we may use the
<code>tmle_vimshift_msm</code> Spec (instead of the <code>tmle_vimshift_delta</code> Spec that
appears above):</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize a tmle specification</span>
<span class="va">tmle_msm_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/tmle3shift/reference/tmle_vimshift_msm.html">tmle_vimshift_msm</a></span><span class="op">(</span>
  shift_grid <span class="op">=</span> <span class="va">delta_grid</span>,
  max_shifted_ratio <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span>

<span class="co"># fit the TML estimator and examine the results</span>
<span class="va">tmle_msm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle3.html">tmle3</a></span><span class="op">(</span><span class="va">tmle_msm_spec</span>, <span class="va">data</span>, <span class="va">node_list</span>, <span class="va">learner_list</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iter: 1 fn: 1383.8221     Pars:  0.25259038 0.00001286 0.74739676</span>
<span class="co">#&gt; Iter: 2 fn: 1383.8221     Pars:  0.25259037 0.00000784 0.74740179</span>
<span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span>
<span class="va">tmle_msm_fit</span>
<span class="co">#&gt; A tmle3_Fit that took 100 step(s)</span>
<span class="co">#&gt;          type          param init_est tmle_est        se   lower   upper</span>
<span class="co">#&gt; 1: MSM_linear MSM(intercept)  0.73688  0.73682 0.0120245 0.71326 0.76039</span>
<span class="co">#&gt; 2: MSM_linear     MSM(slope)  0.11604  0.11615 0.0053919 0.10558 0.12672</span>
<span class="co">#&gt;    psi_transformed lower_transformed upper_transformed</span>
<span class="co">#&gt; 1:         0.73682           0.71326           0.76039</span>
<span class="co">#&gt; 2:         0.11615           0.10558           0.12672</span></code></pre></div>
</div>
<div id="example-with-the-wash-benefits-data" class="section level3">
<h3>
<span class="header-section-number">6.5.5</span> Example with the WASH Benefits Data<a class="anchor" aria-label="anchor" href="#example-with-the-wash-benefits-data"><i class="fas fa-link"></i></a>
</h3>
<p>To complete our walk through, let’s turn to using stochastic interventions to
investigate the data from the WASH Benefits trial. To start, let’s load the
data, convert all columns to be of class <code>numeric</code>, and take a quick look at it</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">washb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/tlverse/tlverse-data/master/wash-benefits/washb_data_subset.csv"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">washb_data</span> <span class="op">&lt;-</span> <span class="va">washb_data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">momage</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">momheight</span><span class="op">)</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">washb_data</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;      whz          tr fracode month aged    sex momage         momedu momheight</span>
<span class="co">#&gt; 1: -0.94 Handwashing  N06505     7  237   male     21 Primary (1-5y)    146.00</span>
<span class="co">#&gt; 2: -1.13     Control  N06505     8  310 female     26   No education    148.90</span>
<span class="co">#&gt; 3: -1.61     Control  N06524     3  162   male     25 Primary (1-5y)    153.75</span>
<span class="co">#&gt;        hfiacat Nlt18 Ncomp watmin elec floor walls roof asset_wardrobe</span>
<span class="co">#&gt; 1: Food Secure     1    25      2    1     0     1    1              0</span>
<span class="co">#&gt; 2: Food Secure     1     7      4    1     0     0    1              0</span>
<span class="co">#&gt; 3: Food Secure     0    15      2    0     0     1    1              0</span>
<span class="co">#&gt;    asset_table asset_chair asset_khat asset_chouki asset_tv asset_refrig</span>
<span class="co">#&gt; 1:           1           0          0            1        0            0</span>
<span class="co">#&gt; 2:           1           1          0            1        0            0</span>
<span class="co">#&gt; 3:           1           0          1            1        0            0</span>
<span class="co">#&gt;    asset_bike asset_moto asset_sewmach asset_mobile</span>
<span class="co">#&gt; 1:          0          0             0            0</span>
<span class="co">#&gt; 2:          0          0             0            1</span>
<span class="co">#&gt; 3:          0          0             0            0</span></code></pre></div>
<p>Next, we specify our NPSEM via the <code>node_list</code> object. For our example analysis,
we’ll consider the outcome to be the weight-for-height Z-score (as in previous
sections), the intervention of interest to be the mother’s age at time of
child’s birth, and take all other covariates to be potential confounders.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">node_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">washb_data</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">washb_data</span><span class="op">)</span> <span class="op">%in%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"whz"</span>, <span class="st">"momage"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,
  A <span class="op">=</span> <span class="st">"momage"</span>, Y <span class="op">=</span> <span class="st">"whz"</span>
<span class="op">)</span></code></pre></div>
<p>Were we to consider the counterfactual weight-for-height Z-score under shifts in
the age of the mother at child’s birth, how would we interpret estimates of our
parameter?</p>
<p>To simplify our interpretation, consider a shift (up or down) of two years in
the mother’s age (i.e., <span class="math inline">\(\delta = \{-2, 0, 2\}\)</span>); in this setting, a stochastic
intervention would correspond to a policy advocating that potential mothers
defer or accelerate plans of having a child for two calendar years, possibly
implemented through the deployment of an encouragement design.</p>
<p>First, let’s try a simple upward shift of just two years:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize a tmle specification for just a single delta shift</span>
<span class="va">washb_shift_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/tmle3shift/reference/tmle_shift.html">tmle_shift</a></span><span class="op">(</span>
  shift_val <span class="op">=</span> <span class="fl">2</span>,
  shift_fxn <span class="op">=</span> <span class="va">shift_additive</span>,
  shift_fxn_inv <span class="op">=</span> <span class="va">shift_additive_inv</span>
<span class="op">)</span></code></pre></div>
<p>To examine the effect modification approach we looked at in previous chapters,
we’ll estimate the effect of this shift <span class="math inline">\(\delta = 2\)</span> while stratifying on the
mother’s education level (<code>momedu</code>, a categorical variable with three levels).
For this, we augment our initialized <code>tmle3_Spec</code> object like so</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize effect modification specification around previous specification</span>
<span class="va">washb_shift_strat_spec</span> <span class="op">&lt;-</span>  <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle_stratified.html">tmle_stratified</a></span><span class="op">(</span><span class="va">washb_shift_spec</span><span class="op">)</span></code></pre></div>
<p>Prior to running our analysis, we’ll modify the <code>learner_list</code> object we had
created to include just one of the semiparametric location-scale conditional
density estimators, as fitting of these estimators is much faster than the more
computationally intensive approach implemented in the
<a href="ihttps://CRAN.R-project.org/package=haldensify"><code>haldensify</code> package</a>
<span class="citation">(Hejazi, Benkeser, and van der Laan <a href="references.html#ref-hejazi2020haldensify" role="doc-biblioref">2020</a>)</span>.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># learners used for conditional density regression (i.e., propensity score),</span>
<span class="co"># but we need to turn on cross-validation for this conditional density learner</span>
<span class="va">hose_learner_xgb_cv</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_cv.html">Lrnr_cv</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  learner <span class="op">=</span> <span class="va">hose_learner_xgb</span>,
  full_fit <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="co"># modify learner list, using existing SL for Q fit</span>
<span class="va">learner_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Q_learner</span>, A <span class="op">=</span> <span class="va">hose_learner_xgb_cv</span><span class="op">)</span></code></pre></div>
<p>Now we’re ready to construct a TML estimate of the shift parameter at
<span class="math inline">\(\delta = 2\)</span>, stratified across levels of our variable of interest:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit stratified TMLE</span>
<span class="va">strat_node_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">node_list</span><span class="op">)</span>
<span class="va">strat_node_list</span><span class="op">$</span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="va">strat_node_list</span><span class="op">$</span><span class="va">W</span>,<span class="st">"momedu"</span><span class="op">)</span>
<span class="va">strat_node_list</span><span class="op">$</span><span class="va">V</span> <span class="op">&lt;-</span> <span class="st">"momedu"</span>
<span class="va">washb_shift_strat_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle3.html">tmle3</a></span><span class="op">(</span><span class="va">washb_shift_strat_spec</span>, <span class="va">washb_data</span>, <span class="va">strat_node_list</span>,
                               <span class="va">learner_list</span><span class="op">)</span>
<span class="va">washb_shift_strat_fit</span>
<span class="co">#&gt; A tmle3_Fit that took 1 step(s)</span>
<span class="co">#&gt;              type                             param init_est tmle_est       se</span>
<span class="co">#&gt; 1:            TSM                     E[Y_{A=NULL}] -0.57206 -0.56936 0.048211</span>
<span class="co">#&gt; 2: stratified TSM  E[Y_{A=NULL}] | V=Primary (1-5y) -0.62295 -0.69200 0.076813</span>
<span class="co">#&gt; 3: stratified TSM    E[Y_{A=NULL}] | V=No education -0.68673 -0.86672 0.128939</span>
<span class="co">#&gt; 4: stratified TSM E[Y_{A=NULL}] | V=Secondary (&gt;5y) -0.50717 -0.40686 0.067633</span>
<span class="co">#&gt;       lower    upper psi_transformed lower_transformed upper_transformed</span>
<span class="co">#&gt; 1: -0.66385 -0.47487        -0.56936          -0.66385          -0.47487</span>
<span class="co">#&gt; 2: -0.84255 -0.54145        -0.69200          -0.84255          -0.54145</span>
<span class="co">#&gt; 3: -1.11944 -0.61401        -0.86672          -1.11944          -0.61401</span>
<span class="co">#&gt; 4: -0.53942 -0.27431        -0.40686          -0.53942          -0.27431</span></code></pre></div>
<p>For the next example, we’ll use the variable importance strategy of considering
a grid of stochastic interventions to evaluate the weight-for-height Z-score
under a shift in the mother’s age down by two years (<span class="math inline">\(\delta = -2\)</span>) through up
by two years (<span class="math inline">\(\delta = 2\)</span>), incrementing by a single year between the two. To
do this, we simply initialize a <code>Spec</code> <code>tmle_vimshift_delta</code> similar to how we
did in a previous example:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># initialize a tmle specification for the variable importance parameter</span>
<span class="va">washb_vim_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tlverse.org/tmle3shift/reference/tmle_vimshift_delta.html">tmle_vimshift_delta</a></span><span class="op">(</span>
  shift_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  max_shifted_ratio <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
<p>Having made the above preparations, we’re now ready to estimate the
counterfactual mean of the weight-for-height Z-score under a small grid of
shifts in the mother’s age at child’s birth. Just as before, we do this through
a simple call to our <code>tmle3</code> wrapper function:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">washb_tmle_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/tmle3/reference/tmle3.html">tmle3</a></span><span class="op">(</span><span class="va">washb_vim_spec</span>, <span class="va">washb_data</span>, <span class="va">node_list</span>, <span class="va">learner_list</span><span class="op">)</span>
<span class="va">washb_tmle_fit</span>
<span class="co">#&gt; A tmle3_Fit that took 1 step(s)</span>
<span class="co">#&gt;          type          param   init_est   tmle_est        se      lower</span>
<span class="co">#&gt; 1:        TSM  E[Y_{A=NULL}] -0.5608084 -0.5552156 0.0469064 -0.6471504</span>
<span class="co">#&gt; 2:        TSM  E[Y_{A=NULL}] -0.5638623 -0.5644702 0.0466125 -0.6558290</span>
<span class="co">#&gt; 3:        TSM  E[Y_{A=NULL}] -0.5663920 -0.5652941 0.0466314 -0.6566901</span>
<span class="co">#&gt; 4:        TSM  E[Y_{A=NULL}] -0.5687408 -0.5681002 0.0463126 -0.6588712</span>
<span class="co">#&gt; 5:        TSM  E[Y_{A=NULL}] -0.5708337 -0.5716047 0.0468992 -0.6635256</span>
<span class="co">#&gt; 6: MSM_linear MSM(intercept) -0.5661274 -0.5649370 0.0465180 -0.6561105</span>
<span class="co">#&gt; 7: MSM_linear     MSM(slope) -0.0024929 -0.0036408 0.0012834 -0.0061563</span>
<span class="co">#&gt;         upper psi_transformed lower_transformed upper_transformed</span>
<span class="co">#&gt; 1: -0.4632807      -0.5552156        -0.6471504        -0.4632807</span>
<span class="co">#&gt; 2: -0.4731114      -0.5644702        -0.6558290        -0.4731114</span>
<span class="co">#&gt; 3: -0.4738982      -0.5652941        -0.6566901        -0.4738982</span>
<span class="co">#&gt; 4: -0.4773292      -0.5681002        -0.6588712        -0.4773292</span>
<span class="co">#&gt; 5: -0.4796839      -0.5716047        -0.6635256        -0.4796839</span>
<span class="co">#&gt; 6: -0.4737634      -0.5649370        -0.6561105        -0.4737634</span>
<span class="co">#&gt; 7: -0.0011254      -0.0036408        -0.0061563        -0.0011254</span></code></pre></div>
<hr>
</div>
</div>
<div id="exercises-1" class="section level2">
<h2>
<span class="header-section-number">6.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Set the <code>sl3</code> library of algorithms for the Super Learner to a simple,
interpretable library and use this new library to estimate the counterfactual
mean of mother’s age at child’s birth (<code>momage</code>) under a shift <span class="math inline">\(\delta = 0\)</span>.
What does this counterfactual mean equate to in terms of the observed data?</p></li>
<li><p>Describe two (equivalent) ways in which the causal effects of stochastic
interventions may be interpreted.</p></li>
<li><p>Using a grid of values of the shift parameter <span class="math inline">\(\delta\)</span> (e.g., <span class="math inline">\(\{-1, 0, +1\}\)</span>), repeat the analysis on the variable of interest (<code>momage</code>),
summarizing the trend for this sequence of shifts using a marginal structural
model.</p></li>
<li><p>For either the grid of shifts in the example preceding the exercises or that
estimated in (3) above, plot the resultant estimates against their respective
counterfactual shifts. Graphically add to the scatterplot a line with slope
and intercept equivalent to the MSM fit through the individual TML estimates.</p></li>
<li><p>How does the marginal structural model we used to summarize the trend along
the sequence of shifts previously help to contextualize the estimated effect
for a single shift? That is, how does access to estimates across several
shifts and the marginal structural model parameters allow us to more richly
interpret our findings?</p></li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="optimal-individualized-treatment-regimes-optional.html"><span class="header-section-number">5</span> Optimal Individualized Treatment Regimes (optional)</a></div>
<div class="next"><a href="r6.html"><span class="header-section-number">7</span> A Primer on the R6 Class System</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#stochastic-treatment-regimes-optional"><span class="header-section-number">6</span> Stochastic Treatment Regimes (optional)</a></li>
<li><a class="nav-link" href="#learning-objectives-4"><span class="header-section-number">6.1</span> Learning Objectives</a></li>
<li><a class="nav-link" href="#introduction-2"><span class="header-section-number">6.2</span> Introduction</a></li>
<li>
<a class="nav-link" href="#stochastic-interventions"><span class="header-section-number">6.3</span> Stochastic Interventions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identifying-the-causal-effect-of-a-stochastic-intervention"><span class="header-section-number">6.3.1</span> Identifying the Causal Effect of a Stochastic Intervention</a></li>
<li><a class="nav-link" href="#interpreting-the-causal-effect-of-a-stochastic-intervention"><span class="header-section-number">6.3.2</span> Interpreting the Causal Effect of a Stochastic Intervention</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#estimating-the-causal-effect-of-a-stochastic-intervention-with-tmle3shift"><span class="header-section-number">6.4</span> Estimating the Causal Effect of a Stochastic Intervention with tmle3shift</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#simulate-data-1"><span class="header-section-number">6.4.1</span> Simulate Data</a></li>
<li><a class="nav-link" href="#targeted-estimation-of-stochastic-interventions-effects"><span class="header-section-number">6.4.2</span> Targeted Estimation of Stochastic Interventions Effects</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#stochastic-interventions-over-a-grid-of-counterfactual-shifts"><span class="header-section-number">6.5</span> Stochastic Interventions over a Grid of Counterfactual Shifts</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#initializing-vimshift-through-its-tmle3_spec"><span class="header-section-number">6.5.1</span> Initializing vimshift through its tmle3_Spec</a></li>
<li><a class="nav-link" href="#targeted-estimation-of-stochastic-intervention-effects"><span class="header-section-number">6.5.2</span> Targeted Estimation of Stochastic Intervention Effects</a></li>
<li><a class="nav-link" href="#inference-with-marginal-structural-models"><span class="header-section-number">6.5.3</span> Inference with Marginal Structural Models</a></li>
<li><a class="nav-link" href="#directly-targeting-the-msm-parameter-beta"><span class="header-section-number">6.5.4</span> Directly Targeting the MSM Parameter \(\beta\)</a></li>
<li><a class="nav-link" href="#example-with-the-wash-benefits-data"><span class="header-section-number">6.5.5</span> Example with the WASH Benefits Data</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exercises-1"><span class="header-section-number">6.6</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tlverse/tlverse-workshops/blob/master/07-tmle3shift.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tlverse/tlverse-workshops/edit/master/07-tmle3shift.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>[Workshop] Targeted Learning in the <code>tlverse</code></strong>: Causal Inference Meets Machine Learning" was written by Mark van der Laan, Alan Hubbard, Jeremy Coyle, Nima Hejazi, Ivana Malenica, Rachael Phillips. It was last built on updated: May 20, 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
